Index: src/javascript/idpselect.js
===================================================================
--- src/javascript/idpselect.js	(revision 157)
+++ src/javascript/idpselect.js	(working copy)
@@ -217,6 +217,7 @@
         //
         var policy = 'urn:oasis:names:tc:SAML:profiles:SSO:idpdiscovery-protocol:single';
         var i;
+        var splitIndex;
         var isPassive = false;
         var parms;
         var parmPair;
@@ -257,10 +258,15 @@
             }
 
             for (i = 0; i < parms.length; i++) {
-                parmPair = parms[i].split('=');
-                if (parmPair.length != 2) {
+                //
+                // Do not use split('='), '=' may be present in the param value
+                //
+                splitIndex = parms[i].indexOf('=');
+                if (splitIndex < 0) {
                     continue;
                 }
+                parmPair = [parms[i].substring(0, splitIndex), parms[i].substring(splitIndex+1)];
+
                 if (parmPair[0] == 'entityID') {
                     suppliedEntityId = decodeURIComponent(parmPair[1]);
                 } else if (parmPair[0] == 'return') {
@@ -329,10 +335,15 @@
         parmlist = returnString.substring(i+1);
         parms = parmlist.split('&');
         for (i = 0; i < parms.length; i++) {
-            parmPair = parms[i].split('=');
-            if (parmPair.length != 2) {
+            //
+            // Do not use split('='), '=' may be present in the param value
+            //
+            splitIndex = parms[i].indexOf('=');
+            if (splitIndex < 0) {
                 continue;
             }
+            parmPair = [parms[i].substring(0, splitIndex), parms[i].substring(splitIndex+1)];
+
             parmPair[1] = decodeURIComponent(parmPair[1]);
             returnParms.push(parmPair);
         }
